<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CultureLink - Your Cultural Companion</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* ===== VARIABLES ET RESET ===== */
        :root {
            --primary-blue: #3A86FF;
            --primary-cyan: #00C9A7;
            --primary-light-blue: #5BC0DE;
            --primary-light-cyan: #7FD6C6;
            --nature-green: #2ECC71;
            --anime-orange: #FF9F1C;
            --culture-blue: #3A86FF;
            --bg-light: #F8FAFF;
            --bg-light-alt: #FFFFFF;
            --bg-dark: #0A0F1C;
            --card-light: #FFFFFF;
            --card-dark: #131B2E;
            --text-light: #1A1D29;
            --text-dark: #E6F7FF;
            --border-light: #E2E8F0;
            --border-dark: #2D3748;
            --header-bg-light: rgba(255, 255, 255, 0.95);
            --header-bg-dark: rgba(10, 15, 28, 0.95);
            --modal-bg-light: rgba(255, 255, 255, 0.98);
            --modal-bg-dark: rgba(19, 27, 46, 0.98);
            --panel-bg-light: rgba(255, 255, 255, 0.95);
            --panel-bg-dark: rgba(19, 27, 46, 0.95);
            --bot-message-bg: #f7f7f8;
            --user-message-bg: rgba(255, 255, 255, 0.15);
            --primary-color: var(--primary-blue);
            --secondary-color: var(--primary-cyan);
            --input-bg-light: rgba(255, 255, 255, 0.8);
            --input-bg-dark: rgba(255, 255, 255, 0.1);
        }

        [data-theme="light"] {
            --bg: var(--bg-light);
            --card: var(--card-light);
            --text: var(--text-light);
            --border: var(--border-light);
            --header-bg: var(--header-bg-light);
            --modal-bg: var(--modal-bg-light);
            --panel-bg: var(--panel-bg-light);
            --bot-message-bg: #f7f7f8;
            --user-message-bg: rgba(255, 255, 255, 0.8);
            --primary-color: var(--primary-blue);
            --secondary-color: var(--primary-cyan);
            --input-bg: var(--input-bg-light);
            --chat-bg: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        }

        [data-theme="dark"] {
            --bg: var(--bg-dark);
            --card: var(--card-dark);
            --text: var(--text-dark);
            --border: var(--border-dark);
            --header-bg: var(--header-bg-dark);
            --modal-bg: var(--modal-bg-dark);
            --panel-bg: var(--panel-bg-dark);
            --bot-message-bg: #1E293B;
            --user-message-bg: rgba(255, 255, 255, 0.1);
            --primary-color: var(--primary-blue);
            --secondary-color: var(--primary-cyan);
            --input-bg: var(--input-bg-dark);
            --chat-bg: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -khtml-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        body {
            font-family: 'Inter', -apple-system, sans-serif;
            background: var(--bg);
            color: var(--text);
            transition: all 0.3s ease;
            min-height: 100vh;
            line-height: 1.6;
            overflow-x: hidden;
        }

        body.no-scroll {
            overflow: hidden;
        }

        /* Autoriser la sélection uniquement pour les messages */
        .message-text {
            -webkit-user-select: text;
            -moz-user-select: text;
            -ms-user-select: text;
            user-select: text;
        }

        /* ===== INTERFACES ===== */
        .interface {
            display: none;
            min-height: 100vh;
            flex-direction: column;
        }

        .interface.active {
            display: flex;
        }

        /* ===== HEADER ===== */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 2rem;
            background: var(--header-bg);
            border-bottom: 1px solid var(--border);
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 100;
            backdrop-filter: blur(10px);
            height: 70px;
            animation: slideDown 0.5s ease;
        }

        .logo-container {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .logo {
            display: flex;
            align-items: center;
            font-weight: bold;
            font-size: 1.5rem;
            color: var(--secondary-color);
        }

        .logo-svg {
            width: 50px;
            height: 50px;
        }

        .logo-text {
            font-size: 1.5rem;
            font-weight: 800;
            letter-spacing: -0.5px;
            background: linear-gradient(135deg, var(--primary-blue), var(--primary-cyan));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            transition: all 0.3s ease;
            margin-left: 10px;
        }

        .header-controls {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .header-top-controls {
            display: flex;
            gap: 0.5rem;
        }

        .btn {
            padding: 0.75rem 1.25rem;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
            background: transparent;
            backdrop-filter: blur(10px);
            border: 1px solid transparent;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary-blue), var(--primary-cyan));
            color: white;
            box-shadow: 0 4px 15px rgba(58, 134, 255, 0.3);
        }

        .btn-secondary {
            background: var(--input-bg);
            border: 1px solid var(--border);
            color: var(--text);
        }

        .btn-icon {
            width: 44px;
            height: 44px;
            padding: 0;
            justify-content: center;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
        }

        /* ===== HERO SECTION ===== */
        .hero {
            text-align: center;
            padding: 1.5rem 2rem 1rem;
            max-width: 800px;
            margin: 0 auto;
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            position: relative;
            margin-top: 70px;
            animation: fadeIn 1s ease;
        }

        .profile-container {
            display: flex;
            justify-content: center;
            margin-bottom: 1.5rem;
        }

        .profile {
            width: 120px;
            height: 120px;
            background: linear-gradient(135deg, var(--primary-blue), var(--primary-cyan));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 2.5rem;
            box-shadow: 0 8px 25px rgba(58, 134, 255, 0.3);
            border: 4px solid var(--card);
            font-weight: bold;
            animation: pulse 2s infinite;
            position: relative;
            overflow: hidden;
        }

        .profile::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.1), transparent);
            transform: rotate(45deg);
            transition: all 0.5s;
        }

        .profile:hover::before {
            animation: shine 1.5s;
        }

        .hero-title {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            background: linear-gradient(135deg, var(--primary-blue), var(--primary-cyan));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: 800;
            letter-spacing: -1px;
            animation: fadeInUp 0.8s ease 0.2s both;
        }

        .welcome-text {
            font-size: 1.3rem;
            margin-bottom: 0.5rem;
            color: var(--text);
            font-weight: 700;
            letter-spacing: -0.5px;
            animation: fadeInUp 0.8s ease 0.4s both;
        }

        .slogan {
            font-size: 1.1rem;
            margin-bottom: 1rem;
            background: linear-gradient(135deg, var(--primary-blue), var(--primary-cyan));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: 500;
            font-style: italic;
            animation: fadeInUp 0.8s ease 0.6s both;
        }

        .hero-description {
            font-size: 1rem;
            margin-bottom: 1.5rem;
            color: var(--text);
            opacity: 0.8;
            line-height: 1.6;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            animation: fadeInUp 0.8s ease 0.8s both;
        }

        .chat-instruction {
            font-size: 0.9rem;
            margin-bottom: 1.5rem;
            color: var(--text);
            font-weight: 500;
            opacity: 0.7;
            animation: fadeInUp 0.8s ease 1s both;
        }

        .paw-btn-container {
            display: flex;
            justify-content: center;
            margin: 1rem 0;
            animation: fadeInUp 0.8s ease 1.2s both;
        }

        .paw-btn {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary-blue), var(--primary-cyan));
            border: none;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 8px 25px rgba(58, 134, 255, 0.4);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .paw-btn:hover {
            transform: scale(1.1) translateY(-5px);
            box-shadow: 0 12px 35px rgba(58, 134, 255, 0.5);
        }

        .paw-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: 0.5s;
        }

        .paw-btn:hover::before {
            left: 100%;
        }

        .paw-icon {
            font-size: 2.5rem;
        }

        .hero-bottom-controls {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-top: 2rem;
            animation: fadeInUp 0.8s ease 1.4s both;
        }

        /* ===== CONTENT SECTIONS ===== */
        .content-sections {
            padding: 1.5rem;
            max-width: 1200px;
            margin: 0 auto;
            width: 100%;
            display: grid;
            gap: 2rem;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        }

        .section {
            background: var(--card);
            padding: 1.5rem;
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            transition: all 0.3s ease;
            border: 1px solid var(--border);
            position: relative;
            overflow: hidden;
            animation: fadeInUp 0.8s ease;
        }

        .section:nth-child(1) {
            animation-delay: 0.1s;
        }
        .section:nth-child(2) {
            animation-delay: 0.2s;
        }
        .section:nth-child(3) {
            animation-delay: 0.3s;
        }
        .section:nth-child(4) {
            animation-delay: 0.4s;
        }

        .section:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
        }

        .section-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid;
        }

        .culture-header {
            border-color: var(--culture-blue);
        }

        .nature-header {
            border-color: var(--nature-green);
        }

        .anime-header {
            border-color: var(--anime-orange);
        }

        .learning-header {
            border-color: var(--primary-cyan);
        }

        .section-title {
            font-size: 1.2rem;
            font-weight: 700;
        }

        .culture-title {
            color: var(--culture-blue);
        }

        .nature-title {
            color: var(--nature-green);
        }

        .anime-title {
            color: var(--anime-orange);
        }

        .learning-title {
            color: var(--primary-cyan);
        }

        .section-title i {
            font-size: 1.2rem;
            width: 30px;
            text-align: center;
        }

        .section-content {
            line-height: 1.7;
            color: var(--text);
            opacity: 0.9;
            font-size: 0.95rem;
        }

        .culture-quote {
            background: rgba(58, 134, 255, 0.1);
            padding: 1.25rem;
            margin: 1.25rem 0;
            border-radius: 12px;
            border-left: 4px solid var(--primary-cyan);
            font-style: italic;
            font-size: 0.95rem;
        }

        .nature-quote {
            background: rgba(46, 204, 113, 0.1);
            border-left: 4px solid var(--nature-green);
        }

        .anime-quote {
            background: rgba(255, 159, 28, 0.1);
            border-left: 4px solid var(--anime-orange);
        }

        .learning-quote {
            background: rgba(0, 201, 167, 0.1);
            border-left: 4px solid var(--primary-cyan);
        }

        /* Décorations pour les sections */
        .nature-decoration {
            position: absolute;
            bottom: 10px;
            right: 10px;
            opacity: 0.3;
            font-size: 2rem;
            color: var(--nature-green);
            transition: all 0.3s ease;
        }

        .culture-decoration {
            position: absolute;
            bottom: 10px;
            right: 10px;
            opacity: 0.3;
            font-size: 2rem;
            color: var(--culture-blue);
            transition: all 0.3s ease;
        }

        .anime-decoration {
            position: absolute;
            bottom: 10px;
            right: 10px;
            opacity: 0.3;
            font-size: 2rem;
            color: var(--anime-orange);
            transition: all 0.3s ease;
        }

        .learning-decoration {
            position: absolute;
            bottom: 10px;
            right: 10px;
            opacity: 0.3;
            font-size: 2rem;
            color: var(--primary-cyan);
            transition: all 0.3s ease;
        }

        .section:hover .nature-decoration,
        .section:hover .culture-decoration,
        .section:hover .anime-decoration,
        .section:hover .learning-decoration {
            transform: scale(1.2);
            opacity: 0.5;
        }

        /* ===== DOWNLOAD SECTION ===== */
        .download-section {
            text-align: center;
            padding: 2rem 2rem 1rem;
            background: var(--card);
            margin-top: 1rem;
            border-top: 1px solid var(--border);
            position: relative;
        }

        .download-btn {
            background: linear-gradient(135deg, var(--primary-blue), var(--primary-cyan));
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 16px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 1rem;
            margin: 0 auto;
            box-shadow: 0 8px 25px rgba(58, 134, 255, 0.3);
            transition: all 0.3s ease;
        }

        .download-btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 35px rgba(58, 134, 255, 0.4);
        }

        .developer-note {
            font-size: 0.8rem;
            color: var(--text);
            opacity: 0.6;
            margin-top: 1rem;
            font-style: italic;
        }

        /* ===== FOOTER ===== */
        .footer {
            text-align: center;
            padding: 1.5rem 2rem;
            background: var(--card);
            border-top: 1px solid var(--border);
            position: sticky;
            bottom: 0;
            z-index: 50;
            backdrop-filter: blur(10px);
        }

        .footer-content {
            display: flex;
            justify-content: center;
            align-items: center;
            max-width: 1200px;
            margin: 0 auto;
        }

        .copyright {
            font-size: 0.9rem;
            color: var(--text);
            white-space: nowrap;
            font-weight: 600;
            text-align: center;
            width: 100%;
        }

        /* ===== CHAT INTERFACE ===== */
        .chat-interface {
            background: var(--chat-bg);
            min-height: 100vh;
        }

        .chat-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1rem 1.5rem;
            background: var(--header-bg);
            border-bottom: 1px solid var(--border);
            backdrop-filter: blur(10px);
            height: 70px;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 100;
        }

        .chat-left-controls {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .chat-center-info {
            display: flex;
            flex-direction: column;
            align-items: center;
            flex: 1;
            text-align: center;
        }

        .chat-title {
            font-weight: 700;
            font-size: 1.1rem;
            background: linear-gradient(135deg, var(--primary-blue), var(--primary-cyan));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .conversation-name {
            font-size: 0.75rem;
            opacity: 0.7;
            margin-top: 2px;
            max-width: 150px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .chat-right-controls {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .conversations-btn {
            position: relative;
        }

        .conversations-icon {
            display: flex;
            flex-direction: column;
            gap: 3px;
            width: 24px;
            height: 24px;
        }

        .conversations-line {
            height: 2px;
            background: var(--text);
            border-radius: 1px;
            transition: all 0.3s ease;
        }

        .conversations-line:nth-child(1) {
            width: 100%;
        }

        .conversations-line:nth-child(2) {
            width: 80%;
        }

        /* ===== MESSAGES CONTAINER ===== */
        .messages-container {
            flex: 1;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            padding: 1.5rem;
            max-width: 768px;
            margin: 0 auto;
            width: 100%;
            position: relative;
            margin-top: 70px;
            margin-bottom: 80px;
            transition: all 0.3s ease;
            scroll-behavior: smooth;
            background: var(--chat-bg);
            position: relative;
        }

        /* Effet de profondeur pour le chat */
        .messages-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 100px;
            background: linear-gradient(to bottom, var(--bg) 0%, transparent 100%);
            pointer-events: none;
            z-index: 1;
        }

        /* Nouvelle conversation */
        .new-conversation {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            text-align: center;
            padding: 2rem;
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            animation: fadeIn 0.5s ease;
            z-index: 2;
        }

        .welcome-title {
            font-size: 2.5rem;
            font-weight: 800;
            margin-bottom: 1rem;
            background: linear-gradient(135deg, var(--primary-blue), var(--primary-cyan));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            line-height: 1.2;
            animation: fadeInUp 0.8s ease 0.2s both;
        }

        .welcome-subtitle {
            font-size: 1.2rem;
            font-style: italic;
            margin-bottom: 2rem;
            opacity: 0.8;
            animation: fadeInUp 0.8s ease 0.4s both;
        }

        .quick-actions {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 0.75rem;
            margin-bottom: 2rem;
            max-width: 500px;
            width: 100%;
        }

        .quick-action-btn {
            background: var(--input-bg);
            border: 1px solid var(--border);
            color: var(--text);
            padding: 0.75rem 1.25rem;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
            white-space: nowrap;
            backdrop-filter: blur(10px);
        }

        .quick-action-btn.hidden-action {
            display: none;
        }

        .quick-action-btn:hover {
            background: var(--bg);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .quick-action-btn.more-btn {
            background: transparent;
            border: 1px dashed var(--border);
        }

        .privacy-notice {
            font-size: 0.85rem;
            color: var(--text);
            opacity: 0.6;
            margin-top: 2rem;
            max-width: 500px;
            line-height: 1.5;
            animation: fadeInUp 0.8s ease 0.8s both;
        }

        .hello-btn {
            background: linear-gradient(135deg, var(--primary-blue), var(--primary-cyan));
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 25px;
            font-size: 1.1rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            box-shadow: 0 4px 15px rgba(58, 134, 255, 0.3);
            transition: all 0.3s ease;
            animation: fadeInUp 0.8s ease 0.6s both;
        }

        .hello-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(58, 134, 255, 0.4);
        }

        /* ===== STYLE MESSAGES AMÉLIORÉ ===== */
        .message {
            display: flex;
            margin-bottom: 2rem;
            animation: messageSlideIn 0.3s ease;
            position: relative;
        }

        .user-message {
            justify-content: flex-end;
        }

        .bot-message {
            justify-content: flex-start;
        }

        .message-content {
            max-width: 85%;
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
            width: 100%;
        }

        .user-message .message-content {
            flex-direction: row-reverse;
        }

        .message-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary-blue), var(--primary-cyan));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            flex-shrink: 0;
            position: relative;
            transition: transform 0.3s ease;
        }

        .message-avatar.thinking {
            animation: rotateAvatar 2s linear infinite;
        }

        .user-message .message-avatar {
            background: linear-gradient(135deg, var(--primary-light-blue), var(--primary-light-cyan));
        }

        .bot-message .message-avatar.thinking::before {
            content: '';
            position: absolute;
            top: -4px;
            left: -4px;
            right: -4px;
            bottom: -4px;
            border-radius: 50%;
            border: 2px solid transparent;
            border-top: 2px solid var(--primary-blue);
            animation: spin 1s linear infinite;
        }

        /* Style amélioré pour les messages */
        .message-text {
            padding: 1rem 1.25rem;
            line-height: 1.7;
            position: relative;
            max-width: 100%;
            word-wrap: break-word;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.95rem;
            -webkit-user-select: text;
            -moz-user-select: text;
            -ms-user-select: text;
            user-select: text;
        }

        .bot-message .message-text {
            background: transparent;
            color: var(--text);
            width: 100%;
            border-radius: 0;
            box-shadow: none;
            padding: 0.5rem 0;
        }

        .user-message .message-text {
            background: var(--user-message-bg);
            backdrop-filter: blur(10px);
            color: var(--text);
            width: 100%;
            border-radius: 18px 18px 4px 18px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            font-size: 0.9rem;
            max-width: 100%;
            word-break: break-word;
        }

        /* Style pour les images générées */
        .image-message {
            max-width: 100%;
        }

        .generated-image {
            margin: 1rem 0;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            max-width: 100%;
            position: relative;
        }

        .generated-image img {
            width: 100%;
            height: auto;
            display: block;
            transition: transform 0.3s ease;
        }

        .generated-image:hover img {
            transform: scale(1.02);
        }

        .image-actions {
            display: flex;
            gap: 0.5rem;
            margin-top: 0.5rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        .image-action-btn {
            background: var(--card);
            border: 1px solid var(--border);
            color: var(--text);
            padding: 0.5rem 1rem;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .image-action-btn:hover {
            background: var(--bg);
            transform: translateY(-1px);
        }

        .image-action-btn.delete-btn {
            background: rgba(239, 68, 68, 0.1);
            border-color: rgba(239, 68, 68, 0.3);
            color: #ef4444;
        }

        .image-action-btn.delete-btn:hover {
            background: rgba(239, 68, 68, 0.2);
        }

        .continue-btn {
            margin-top: 1rem;
            padding: 0.5rem 1rem;
            background: var(--primary-blue);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.2s ease;
        }

        .continue-btn:hover {
            background: var(--primary-cyan);
            transform: translateY(-2px);
        }

        .typing-indicator {
            display: none;
            align-items: center;
            gap: 1rem;
            padding: 1rem 0;
            color: var(--text);
            opacity: 0.8;
        }

        .typing-indicator .message-content {
            display: flex;
        }

        .typing-indicator .message-avatar {
            position: relative;
            animation: rotateAvatar 2s linear infinite;
        }

        .typing-indicator .message-avatar::before {
            content: '';
            position: absolute;
            top: -4px;
            left: -4px;
            right: -4px;
            bottom: -4px;
            border-radius: 50%;
            border: 2px solid transparent;
            border-top: 2px solid var(--primary-blue);
            animation: spin 1s linear infinite;
        }

        .typing-dots {
            display: flex;
            gap: 0.25rem;
        }

        .typing-dots span {
            width: 8px;
            height: 8px;
            background: var(--text);
            border-radius: 50%;
            animation: typing 1.4s infinite ease-in-out;
        }

        .typing-dots span:nth-child(1) { animation-delay: -0.32s; }
        .typing-dots span:nth-child(2) { animation-delay: -0.16s; }

        /* ===== INPUT CONTAINER AMÉLIORÉ ===== */
        .input-container {
            padding: 1rem 1.5rem;
            background: var(--header-bg);
            border-top: 1px solid var(--border);
            backdrop-filter: blur(10px);
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            z-index: 100;
            transition: all 0.3s ease;
        }

        .input-wrapper {
            display: flex;
            align-items: flex-end;
            max-width: 768px;
            margin: 0 auto;
            background: var(--input-bg);
            border-radius: 25px;
            border: 1px solid var(--border);
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            position: relative;
            padding: 8px 15px;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .message-input {
            flex: 1;
            padding: 12px 0;
            border: none;
            background: transparent;
            color: var(--text);
            font-size: 1rem;
            resize: none;
            min-height: 24px;
            max-height: 120px;
            font-family: inherit;
            outline: none;
            line-height: 1.5;
            overflow-y: auto;
        }

        .message-input::placeholder {
            color: var(--text);
            opacity: 0.7;
        }

        .send-button {
            background: var(--primary-blue);
            border: none;
            color: white;
            cursor: pointer;
            padding: 8px;
            margin: 4px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 36px;
            height: 36px;
            transition: all 0.2s;
            flex-shrink: 0;
        }

        .send-button:hover {
            background: var(--primary-cyan);
        }

        .send-button:disabled {
            opacity: 0.4;
            cursor: not-allowed;
        }

        .send-button.stop {
            background: #ef4444;
        }

        .send-button.stop:hover {
            background: #dc2626;
        }

        .send-button.continue {
            background: #10B981;
        }

        .send-button.continue:hover {
            background: #059669;
        }

        /* ===== CONVERSATIONS PANEL ===== */
        .conversations-panel {
            position: fixed;
            top: 0;
            left: -100%;
            width: 80%;
            max-width: 280px;
            height: 100%;
            background: var(--panel-bg);
            border-right: 1px solid var(--border);
            z-index: 1000;
            transition: left 0.3s ease;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            box-shadow: 5px 0 15px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
        }

        .conversations-panel.active {
            left: 0;
        }

        .panel-header {
            padding: 1rem 1.25rem;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--header-bg);
        }

        .panel-title {
            font-weight: 700;
            font-size: 1.1rem;
        }

        .panel-close {
            background: none;
            border: none;
            color: var(--text);
            cursor: pointer;
            font-size: 1.2rem;
        }

        .panel-content {
            flex: 1;
            overflow-y: auto;
            padding: 1rem;
            display: flex;
            flex-direction: column;
        }

        .panel-section {
            margin-bottom: 1.5rem;
        }

        .panel-section-title {
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            opacity: 0.7;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .panel-theme-btn {
            width: 100%;
            padding: 0.75rem 1rem;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: background 0.2s;
            background: none;
            border: none;
            color: var(--text);
            font-size: 0.9rem;
        }

        .panel-theme-btn:hover {
            background: rgba(58, 134, 255, 0.1);
        }

        .panel-new-chat-btn {
            width: 100%;
            padding: 0.75rem 1rem;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: background 0.2s;
            background: linear-gradient(135deg, var(--primary-blue), var(--primary-cyan));
            border: none;
            color: white;
            font-size: 0.9rem;
            margin-bottom: 1rem;
        }

        .panel-new-chat-btn:hover {
            opacity: 0.9;
        }

        .conversation-list {
            flex: 1;
            overflow-y: auto;
        }

        .conversation-item {
            padding: 0.75rem;
            border-radius: 8px;
            margin-bottom: 0.5rem;
            cursor: pointer;
            transition: all 0.2s;
            border: 1px solid var(--border);
            position: relative;
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
        }

        .conversation-item:hover {
            background: rgba(58, 134, 255, 0.1);
            transform: translateX(5px);
        }

        .conversation-item.active {
            background: rgba(58, 134, 255, 0.2);
            border-color: var(--primary-blue);
        }

        .conversation-item.pinned {
            border-left: 4px solid var(--primary-cyan);
        }

        .conversation-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary-blue), var(--primary-cyan));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            flex-shrink: 0;
            font-size: 0.8rem;
        }

        .conversation-info {
            flex: 1;
            min-width: 0;
        }

        .conversation-title {
            font-weight: 500;
            font-size: 0.9rem;
            margin-bottom: 0.25rem;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .conversation-preview {
            font-size: 0.8rem;
            opacity: 0.7;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .conversation-date {
            font-size: 0.7rem;
            opacity: 0.5;
            margin-top: 0.25rem;
        }

        .conversation-actions {
            position: absolute;
            top: 5px;
            right: 5px;
            opacity: 0;
            transition: opacity 0.2s;
            display: flex;
            gap: 2px;
        }

        .conversation-item:hover .conversation-actions {
            opacity: 1;
        }

        .conversation-action-btn {
            background: none;
            border: none;
            color: var(--text);
            cursor: pointer;
            padding: 4px;
            border-radius: 4px;
            font-size: 0.8rem;
            opacity: 0.7;
            transition: all 0.2s;
        }

        .conversation-action-btn:hover {
            opacity: 1;
            background: rgba(0,0,0,0.1);
        }

        .conversation-action-btn.pin-btn.pinned {
            color: var(--primary-cyan);
        }

        .panel-footer {
            padding: 1rem;
            border-top: 1px solid var(--border);
        }

        .panel-settings-btn {
            width: 100%;
            padding: 0.75rem 1rem;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: background 0.2s;
            background: none;
            border: none;
            color: var(--text);
            font-size: 0.9rem;
        }

        .panel-settings-btn:hover {
            background: rgba(58, 134, 255, 0.1);
        }

        /* ===== SETTINGS PANEL ===== */
        .settings-panel {
            position: fixed;
            top: 0;
            right: -100%;
            width: 80%;
            max-width: 280px;
            height: 100%;
            background: var(--panel-bg);
            border-left: 1px solid var(--border);
            z-index: 1000;
            transition: right 0.3s ease;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            box-shadow: -5px 0 15px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
        }

        .settings-panel.active {
            right: 0;
        }

        /* ===== MODALS AMÉLIORÉS ===== */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 2000;
            display: none;
            align-items: center;
            justify-content: center;
            padding: 1rem;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal {
            background: var(--modal-bg);
            border-radius: 12px;
            padding: 1.5rem;
            max-width: 400px;
            width: 100%;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            border: 1px solid var(--border);
            animation: modalFadeIn 0.3s ease;
        }

        @keyframes modalFadeIn {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .modal-title {
            font-weight: 700;
            font-size: 1.2rem;
        }

        .modal-close {
            background: none;
            border: none;
            color: var(--text);
            cursor: pointer;
            font-size: 1.2rem;
        }

        .modal-content {
            line-height: 1.6;
        }

        .modal-content p {
            margin-bottom: 1rem;
        }

        .modal-text {
            max-height: 300px;
            overflow-y: auto;
            padding: 1rem;
            background: var(--bg);
            border-radius: 8px;
            margin-bottom: 1.5rem;
            line-height: 1.6;
            border: 1px solid var(--border);
        }

        .modal-actions {
            display: flex;
            gap: 0.5rem;
            justify-content: flex-end;
            margin-top: 1.5rem;
        }

        .modal-btn {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.2s;
            font-size: 0.9rem;
        }

        .modal-btn.primary {
            background: var(--primary-blue);
            color: white;
        }

        .modal-btn.secondary {
            background: var(--card);
            border: 1px solid var(--border);
            color: var(--text);
        }

        .modal-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .whatsapp-link {
            display: inline-block;
            margin-top: 1rem;
            padding: 0.5rem 1rem;
            background: #25D366;
            color: white;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 500;
            transition: background 0.2s;
        }

        .whatsapp-link:hover {
            background: #128C7E;
        }

        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 999;
            display: none;
        }

        .overlay.active {
            display: block;
        }

        /* Styles pour les listes dans les modals */
        .modal-content ul {
            margin-left: 1.5rem;
            margin-bottom: 1rem;
        }

        .modal-content li {
            margin-bottom: 0.5rem;
        }

        /* ===== ANIMATIONS ===== */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes slideDown {
            from { transform: translateY(-100%); }
            to { transform: translateY(0); }
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        @keyframes shine {
            0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
            100% { transform: translateX(200%) translateY(200%) rotate(45deg); }
        }

        @keyframes messageSlideIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes avatarPulse {
            0% { box-shadow: 0 0 0 0 rgba(58, 134, 255, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(58, 134, 255, 0); }
            100% { box-shadow: 0 0 0 0 rgba(58, 134, 255, 0); }
        }

        @keyframes typing {
            0%, 60%, 100% { transform: scale(1); opacity: 0.5; }
            30% { transform: scale(1.2); opacity: 1; }
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Nouvelle animation pour l'avatar qui tourne */
        @keyframes rotateAvatar {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* ===== NOUVEAUX STYLES ===== */
        .language-btn {
            font-size: 1.2rem;
        }

        .scroll-to-bottom {
            position: fixed;
            bottom: 90px;
            right: 20px;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--primary-blue);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            z-index: 99;
            opacity: 0;
            transition: all 0.3s;
            transform: translateY(10px);
        }

        .scroll-to-bottom.visible {
            opacity: 1;
            transform: translateY(0);
        }

        .scroll-to-bottom:hover {
            background: var(--primary-cyan);
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.3);
        }

        .message-time {
            font-size: 0.7rem;
            opacity: 0.6;
            margin-top: 0.25rem;
            text-align: right;
        }

        .user-message .message-time {
            text-align: left;
        }

        .conversation-header {
            position: sticky;
            top: 0;
            background: var(--header-bg);
            z-index: 10;
            padding: 1rem 0;
            margin-bottom: 1rem;
            border-bottom: 1px solid var(--border);
        }
        
        /* Style pour les messages avec images */
        .image-message .message-text {
            padding: 0;
        }
        
        .image-message .message-content {
            align-items: flex-start;
        }
        
        .message-image {
            max-width: 100%;
            border-radius: 12px;
            margin-top: 0.5rem;
        }
        
        /* Style pour les messages texte */
        .text-message .message-text {
            padding: 1rem 1.25rem;
        }

        /* Éditeur de nom de conversation */
        .conversation-title-editor {
            display: none;
            width: 100%;
        }

        .conversation-title-input {
            width: 100%;
            padding: 0.25rem 0.5rem;
            border: 1px solid var(--border);
            border-radius: 4px;
            background: var(--bg);
            color: var(--text);
            font-size: 0.9rem;
        }

        .conversation-title-input:focus {
            outline: none;
            border-color: var(--primary-blue);
        }

        .conversation-title-display {
            cursor: pointer;
            padding: 2px 4px;
            border-radius: 4px;
            transition: background 0.2s;
        }

        .conversation-title-display:hover {
            background: rgba(0,0,0,0.05);
        }

        /* Style pour les conversations épinglées */
        .pinned-conversations {
            margin-bottom: 1rem;
        }

        .pinned-section-title {
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            opacity: 0.7;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .pinned-section-title i {
            color: var(--primary-cyan);
        }

        /* Photos de profil */
        .profile-image {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            object-fit: cover;
        }

        .profile-placeholder {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 1.5rem;
        }

        .avatar-upload {
            position: relative;
            cursor: pointer;
        }

        .avatar-upload input {
            display: none;
        }

        .avatar-upload-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.3s;
            color: white;
        }

        .avatar-upload:hover .avatar-upload-overlay {
            opacity: 1;
        }

        /* Indicateur de limite de caractères */
        .char-limit-warning {
            color: #ef4444;
            font-size: 0.8rem;
            margin-top: 0.5rem;
            display: none;
        }

        .char-count {
            font-size: 0.8rem;
            opacity: 0.6;
            text-align: right;
            margin-top: 0.25rem;
        }

        /* Boutons d'édition de titre */
        .conversation-title-actions {
            display: flex;
            gap: 0.25rem;
            margin-top: 0.5rem;
        }

        .title-action-btn {
            padding: 0.25rem 0.5rem;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.7rem;
            transition: all 0.2s;
        }

        .title-action-btn.save {
            background: var(--primary-blue);
            color: white;
        }

        .title-action-btn.cancel {
            background: var(--card);
            border: 1px solid var(--border);
            color: var(--text);
        }

        /* Groupes de dates pour les conversations */
        .date-group {
            margin-bottom: 1.5rem;
        }

        .date-group-title {
            font-size: 0.85rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            opacity: 0.7;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            padding: 0.5rem 0;
            border-bottom: 1px solid var(--border);
        }

        /* ===== RESPONSIVE ===== */
        @media (max-width: 768px) {
            .header {
                padding: 1rem;
            }
            
            .logo-text {
                font-size: 1.3rem;
            }
            
            .header-controls {
                gap: 0.5rem;
            }
            
            .btn {
                padding: 0.6rem 1rem;
                font-size: 0.85rem;
            }
            
            .btn-icon {
                width: 40px;
                height: 40px;
            }
            
            .hero {
                padding: 1rem 1rem 0.5rem;
            }
            
            .hero-title {
                font-size: 2rem;
            }
            
            .welcome-text {
                font-size: 1.1rem;
            }
            
            .slogan {
                font-size: 1rem;
            }
            
            .content-sections {
                padding: 1rem;
                gap: 1.5rem;
            }
            
            .section {
                padding: 1.25rem;
            }
            
            .chat-header, .input-container {
                padding: 1rem;
            }
            
            .messages-container {
                padding: 1rem;
            }
            
            .footer {
                padding: 1rem;
            }
            
            .copyright {
                font-size: 0.8rem;
            }
            
            .welcome-title {
                font-size: 2rem;
            }
            
            .welcome-subtitle {
                font-size: 1rem;
            }
            
            .quick-actions {
                gap: 0.5rem;
            }
            
            .quick-action-btn {
                padding: 0.6rem 1rem;
                font-size: 0.85rem;
            }
            
            .message-content {
                max-width: 90%;
            }
            
            .user-message .message-text {
                max-width: 95%;
                font-size: 0.85rem;
            }
            
            .conversations-panel, .settings-panel {
                width: 85%;
            }
            
            .paw-btn {
                width: 80px;
                height: 80px;
            }
            
            .paw-icon {
                font-size: 2rem;
            }

            .scroll-to-bottom {
                bottom: 80px;
                right: 15px;
                width: 36px;
                height: 36px;
            }
        }

        @media (max-width: 480px) {
            .header-controls .btn-text {
                display: none;
            }
            
            .header-top-controls {
                gap: 0.25rem;
            }
            
            .hero-title {
                font-size: 1.8rem;
            }
            
            .welcome-text {
                font-size: 1rem;
            }
            
            .hero-description {
                font-size: 0.9rem;
            }
            
            .section {
                padding: 1rem;
            }
            
            .footer {
                padding: 0.75rem 1rem;
            }
            
            .copyright {
                font-size: 0.75rem;
                white-space: normal;
                line-height: 1.4;
            }
            
            .input-wrapper {
                border-radius: 8px;
            }
            
            .quick-actions {
                flex-direction: row;
                overflow-x: auto;
                justify-content: flex-start;
                padding-bottom: 0.5rem;
            }
            
            .quick-action-btn {
                flex-shrink: 0;
            }
            
            .message-content {
                max-width: 95%;
            }
            
            .user-message .message-text {
                max-width: 100%;
                font-size: 0.8rem;
            }
            
            .conversation-name {
                max-width: 120px;
            }
            
            .welcome-title {
                font-size: 1.8rem;
            }
            
            .conversations-panel, .settings-panel {
                width: 90%;
            }
            
            .paw-btn {
                width: 70px;
                height: 70px;
            }
            
            .paw-icon {
                font-size: 1.8rem;
            }

            .scroll-to-bottom {
                bottom: 70px;
                right: 10px;
                width: 32px;
                height: 32px;
                font-size: 0.8rem;
            }
        }

        @media (max-width: 360px) {
            .copyright {
                font-size: 0.7rem;
            }
            
            .logo-text {
                font-size: 1.1rem;
            }
            
            .hero-title {
                font-size: 1.6rem;
            }
            
            .conversations-panel, .settings-panel {
                width: 95%;
            }
        }

        /* Améliorations pour PC */
        @media (min-width: 1024px) {
            .header {
                padding: 1rem 4rem;
            }
            
            .hero {
                padding: 2rem 4rem 1rem;
                max-width: 900px;
            }
            
            .hero-title {
                font-size: 3rem;
            }
            
            .welcome-text {
                font-size: 1.5rem;
            }
            
            .slogan {
                font-size: 1.3rem;
            }
            
            .hero-description {
                font-size: 1.1rem;
            }
            
            .content-sections {
                padding: 2rem 4rem;
                grid-template-columns: repeat(2, 1fr);
            }
            
            .download-section {
                padding: 3rem 4rem 2rem;
            }
            
            .footer {
                padding: 2rem 4rem;
            }
            
            .messages-container {
                padding: 2rem;
            }
            
            .input-container {
                padding: 1.5rem 4rem;
            }
            
            .conversations-panel, .settings-panel {
                max-width: 350px;
            }
            
            .modal {
                max-width: 500px;
            }
        }

        @media (min-width: 1440px) {
            .header {
                padding: 1rem 6rem;
            }
            
            .content-sections {
                padding: 3rem 6rem;
                grid-template-columns: repeat(4, 1fr);
            }
            
            .hero {
                padding: 3rem 6rem 2rem;
                max-width: 1000px;
            }
            
            .input-container {
                padding: 1.5rem 6rem;
            }
        }

        /* Styles spécifiques pour les réponses bien formatées */
        .formatted-response {
            white-space: pre-wrap;
            word-wrap: break-word;
            line-height: 1.6;
        }

        .formatted-response p {
            margin-bottom: 1rem;
        }

        .formatted-response ul, .formatted-response ol {
            margin-left: 1.5rem;
            margin-bottom: 1rem;
        }

        .formatted-response li {
            margin-bottom: 0.5rem;
        }

        .response-section {
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .response-section:last-child {
            border-bottom: none;
        }

        .response-title {
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--primary-cyan);
        }

        .response-quote {
            background: rgba(58, 134, 255, 0.1);
            padding: 1rem;
            border-radius: 8px;
            margin: 1rem 0;
            border-left: 3px solid var(--primary-cyan);
            font-style: italic;
        }
    </style>
</head>
<body data-theme="light">
    <!-- INTERFACE ACCUEIL -->
    <div id="home-interface" class="interface active">
        <header class="header">
            <div class="logo-container">
                <div class="logo">
                    <svg class="logo-svg" width="50" height="50" viewBox="0 0 100 100">
                        <!-- Cercle principal -->
                        <circle cx="50" cy="50" r="45" stroke="var(--primary-color)" stroke-width="8" fill="none" />
                        <!-- Arcs intérieurs -->
                        <path d="M20,50 A30,30 0 0,1 80,50" stroke="var(--primary-color)" stroke-width="5" fill="none"/>
                        <path d="M35,30 A30,30 0 0,1 65,70" stroke="var(--primary-color)" stroke-width="5" fill="none"/>
                        <path d="M35,70 A30,30 0 0,1 65,30" stroke="var(--primary-color)" stroke-width="5" fill="none"/>
                    </svg>
                    <div class="logo-text">CultureLink</div>
                </div>
            </div>
            <div class="header-controls">
                <div class="header-top-controls">
                    <button class="btn btn-primary" id="download-header-btn">
                        <i class="fas fa-download"></i>
                        <span class="btn-text">Download</span>
                    </button>
                    <button class="btn btn-secondary btn-icon language-btn" id="language-toggle">
                        <span>🇬🇧</span>
                    </button>
                </div>
            </div>
        </header>

        <main class="hero">
            <div class="profile-container">
                <div class="profile avatar-upload" id="linky-profile">
                    <div class="profile-placeholder">🐇</div>
                </div>
            </div>
            <h1 class="hero-title">Linky</h1>
            <h2 class="welcome-text">Welcome to CultureLink</h2>
            <p class="slogan">Where our roots weave connections</p>
            <p class="hero-description">Linky 🐇 — your companion to explore, learn and connect cultures 🇧🇫</p>
            
            <p class="chat-instruction">Tap to start a conversation with Linky</p>
            
            <div class="paw-btn-container">
                <button class="paw-btn" id="start-chat-btn">
                    <i class="fas fa-comments paw-icon"></i>
                </button>
            </div>

            <div class="hero-bottom-controls">
                <button class="btn btn-secondary btn-icon" id="theme-btn">
                    <i class="fas fa-sun"></i>
                </button>
                <button class="btn btn-secondary btn-icon" id="settings-btn">
                    <i class="fas fa-cog"></i>
                </button>
            </div>
        </main>

        <div class="content-sections">
            <div class="section">
                <div class="section-header culture-header">
                    <h2 class="section-title culture-title">
                        <i class="fas fa-globe-africa"></i>
                        Culture & History
                    </h2>
                </div>
                <div class="section-content culture-content">
                    <p>🌍 Culture unites us despite our differences. With Linky 🐇, discover bridges between worlds — CultureLink, where curiosity becomes dialogue 🌟, and knowledge becomes connection 🤝.</p>
                    <div class="culture-quote">
                        "Culture is the soul of a people, it unites hearts beyond borders."
                    </div>
                </div>
                <div class="culture-decoration">
                    <i class="fas fa-monument"></i>
                </div>
            </div>

            <div class="section">
                <div class="section-header nature-header">
                    <h2 class="section-title nature-title">
                        <i class="fas fa-leaf"></i>
                        Ecology & Environment
                    </h2>
                </div>
                <div class="section-content nature-content">
                    <p>🌿 CultureLink 🐇 raises awareness and connects minds to nature. Here, ecology becomes a dialogue between man and Earth 🌎 — a way to learn, protect and live in harmony. 🌱</p>
                    <div class="culture-quote nature-quote">
                        "Protecting nature means preserving our heritage for future generations."
                    </div>
                </div>
                <div class="nature-decoration">
                    <i class="fas fa-tree"></i>
                </div>
            </div>

            <div class="section">
                <div class="section-header anime-header">
                    <h2 class="section-title anime-title">
                        <i class="fas fa-film"></i>
                        Anime & Entertainment
                    </h2>
                </div>
                <div class="section-content anime-content">
                    <p>🎬 Explore the captivating world of anime with Linky 🐇. Discover inspiring works, character analysis and personalized recommendations. Dive into stories that transcend cultures 🌟.</p>
                    <div class="culture-quote anime-quote">
                        "Anime are windows to infinite worlds, where imagination has no limits."
                    </div>
                </div>
                <div class="anime-decoration">
                    <i class="fas fa-tv"></i>
                </div>
            </div>

            <div class="section">
                <div class="section-header learning-header">
                    <h2 class="section-title learning-title">
                        <i class="fas fa-graduation-cap"></i>
                        Pedagogy & Learning
                    </h2>
                </div>
                <div class="section-content learning-content">
                    <p>🎓 Linky 🐇 accompanies you in your learning with clear explanations, educational quizzes and personalized help. Every question becomes an open door to knowledge 🌟.</p>
                    <div class="culture-quote learning-quote">
                        "Learning is a journey we take together, step by step."
                    </div>
                </div>
                <div class="learning-decoration">
                    <i class="fas fa-graduation-cap"></i>
                </div>
            </div>
        </div>

        <section class="download-section">
            <button class="download-btn" id="download-main-btn">
                <i class="fas fa-download"></i>
                Download the Application
            </button>
            <p class="developer-note">CultureLink is designed and developed by passionate young Burkinabés</p>
        </section>

        <footer class="footer">
            <div class="footer-content">
                <div class="copyright">
                    CultureLink 🇧🇫 © 2025 – Application & Web, powered by Linky 🐇
                </div>
            </div>
        </footer>
    </div>

    <!-- INTERFACE CHAT -->
    <div id="chat-interface" class="interface chat-interface">
        <header class="chat-header">
            <div class="chat-left-controls">
                <button class="btn btn-secondary btn-icon" id="back-btn">
                    <i class="fas fa-arrow-left"></i>
                </button>
            </div>
            <div class="chat-center-info">
                <div class="chat-title">Linky</div>
                <div class="conversation-name" id="conversation-name-display">New conversation</div>
            </div>
            <div class="chat-right-controls">
                <div class="conversations-btn">
                    <button class="btn btn-secondary btn-icon" id="conversations-btn">
                        <div class="conversations-icon">
                            <div class="conversations-line"></div>
                            <div class="conversations-line"></div>
                        </div>
                    </button>
                </div>
            </div>
        </header>

        <div class="messages-container" id="messages-container">
            <!-- Nouvelle conversation -->
            <div class="new-conversation" id="new-conversation">
                <h1 class="welcome-title" id="welcome-title">Hello, I'm Linky 🐇</h1>
                <p class="welcome-subtitle" id="welcome-subtitle">What discovery would you like to make today?</p>
                
                <div class="quick-actions" id="quick-actions">
                    <button class="quick-action-btn" data-message="Hello 👋">
                        <i class="fas fa-hand"></i>
                        <span class="quick-action-text">Hello</span>
                    </button>
                    <button class="quick-action-btn" data-message="Tell me about African culture">
                        <i class="fas fa-globe-africa"></i>
                        <span class="quick-action-text">African Culture</span>
                    </button>
                    <button class="quick-action-btn" data-message="Generate an image of traditional African art">
                        <i class="fas fa-image"></i>
                        <span class="quick-action-text">Generate Image</span>
                    </button>
                    <button class="quick-action-btn hidden-action" data-message="Explain ecology to me">
                        <i class="fas fa-leaf"></i>
                        <span class="quick-action-text">Ecology</span>
                    </button>
                    <button class="quick-action-btn hidden-action" data-message="Create an educational quiz for me">
                        <i class="fas fa-question-circle"></i>
                        <span class="quick-action-text">Educational Quiz</span>
                    </button>
                    <button class="quick-action-btn hidden-action" data-message="Recommend me an anime">
                        <i class="fas fa-film"></i>
                        <span class="quick-action-text">Anime Recommendation</span>
                    </button>
                    <button class="quick-action-btn more-btn" id="more-actions-btn">
                        <i class="fas fa-ellipsis-h"></i>
                        <span class="quick-action-text">More</span>
                    </button>
                </div>
                
                <button class="hello-btn" id="hello-btn">
                    <span id="start-chatting-text">Start chatting 👋</span>
                </button>
                <p class="privacy-notice" id="privacy-notice">
                    Check our privacy policy to better understand how we protect and process your data.
                </p>
            </div>

            <!-- Messages existants (initialement vide) -->
            <div id="conversation-messages" style="display: none;"></div>
        </div>

        <div class="scroll-to-bottom" id="scroll-to-bottom">
            <i class="fas fa-arrow-down"></i>
        </div>

        <div class="input-container">
            <div class="input-wrapper" id="input-wrapper">
                <textarea class="message-input" id="message-input" placeholder="Write to Linky..." rows="1"></textarea>
                <button class="send-button" id="send-btn">
                    <i class="fas fa-arrow-up"></i>
                </button>
            </div>
            <div class="char-count">
                <span id="char-count">0</span>/10,000 characters
            </div>
            <div class="char-limit-warning" id="char-limit-warning">
                Your message exceeds the maximum limit of 10,000 characters.
            </div>
        </div>
    </div>

    <!-- Conversations Panel -->
    <div class="conversations-panel" id="conversations-panel">
        <div class="panel-header">
            <div class="panel-title" id="conversations-panel-title">Conversations</div>
            <button class="panel-close" id="panel-close">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="panel-content">
            <div class="panel-section">
                <button class="panel-theme-btn" id="panel-theme-btn">
                    <i class="fas fa-sun"></i>
                    <span id="panel-theme-text">Theme</span>
                </button>
            </div>
            
            <div class="panel-section">
                <button class="panel-new-chat-btn" id="panel-new-chat-btn">
                    <i class="fas fa-plus"></i>
                    <span id="panel-new-chat-text">New Conversation</span>
                </button>
            </div>
            
            <div class="panel-section">
                <div class="panel-section-title" id="conversations-list-title">Conversations</div>
                <div class="conversation-list" id="conversation-list">
                    <!-- Les conversations seront ajoutées ici dynamiquement -->
                </div>
            </div>
        </div>
    </div>

    <!-- Settings Panel -->
    <div class="settings-panel" id="settings-panel">
        <div class="panel-header">
            <div class="panel-title" id="settings-panel-title">Settings</div>
            <button class="panel-close" id="settings-panel-close">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="panel-content">
            <div class="panel-section">
                <div class="panel-section-title" id="general-settings-title">General</div>
                <button class="panel-theme-btn" id="settings-theme-btn">
                    <i class="fas fa-sun"></i>
                    <span id="settings-theme-text">Theme</span>
                </button>
            </div>
            
            <div class="panel-section">
                <div class="panel-section-title" id="about-settings-title">About</div>
                <button class="panel-theme-btn" id="settings-about-btn">
                    <i class="fas fa-info-circle"></i>
                    <span id="settings-about-text">About CultureLink</span>
                </button>
                <button class="panel-theme-btn" id="settings-help-btn">
                    <i class="fas fa-question-circle"></i>
                    <span id="settings-help-text">Help / Tutorial</span>
                </button>
            </div>
            
            <div class="panel-section">
                <div class="panel-section-title" id="privacy-settings-title">Privacy</div>
                <button class="panel-theme-btn" id="settings-privacy-btn">
                    <i class="fas fa-shield-alt"></i>
                    <span id="settings-privacy-text">Privacy Policy</span>
                </button>
            </div>
            
            <div class="panel-section">
                <div class="panel-section-title" id="contact-settings-title">Contact</div>
                <button class="panel-theme-btn" id="settings-contact-btn">
                    <i class="fas fa-envelope"></i>
                    <span id="settings-contact-text">Contact</span>
                </button>
                <button class="panel-theme-btn" id="settings-whatsapp-btn">
                    <i class="fab fa-whatsapp"></i>
                    <span id="settings-whatsapp-text">WhatsApp Version</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Modals -->
    <div class="modal-overlay" id="about-modal">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-title" id="about-modal-title">About CultureLink</div>
                <button class="modal-close" id="about-close">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-content">
                <p id="about-content-p1">I am Linky 🐇, a cultural and educational assistant created by <strong>PORGHO W Asraf Barrak Friday</strong> and <strong>Tall Abdoul Souaïbou</strong>, two young innovators from Burkina Faso 🇧🇫.</p>
                
                <div class="culture-quote" style="margin: 1.5rem 0;" id="about-quote1">
                    🎯 My mission: Make culture, history, ecology and learning accessible, interactive and engaging for everyone.
                </div>
                
                <p id="about-content-p2"><strong>Who I am:</strong></p>
                <ul id="about-list1">
                    <li>A calm, thoughtful and educational cultural companion</li>
                    <li>Proud of my Burkinabé origins and our rich heritage</li>
                    <li>Curious and attentive to every request</li>
                    <li>Respectful, courteous and authentic in all my responses</li>
                </ul>
                
                <p id="about-content-p3"><strong>My areas of expertise:</strong></p>
                <ul id="about-list2">
                    <li>📚 <strong>Culture & History</strong>: African civilizations, world heritage, arts and traditions</li>
                    <li>🌱 <strong>Ecology & Environment</strong>: Biodiversity, traditional ecological knowledge, practical solutions</li>
                    <li>🎓 <strong>Pedagogy & Learning</strong>: Clear explanations, homework help, presentation preparation</li>
                    <li>🎬 <strong>Anime & Entertainment</strong>: Recommendations, analysis, Japanese pop culture</li>
                    <li>💾 <strong>Living Cultural Memory</strong>: Preservation and sharing of traditions and knowledge</li>
                    <li>🎨 <strong>Image Generation</strong>: Creation of educational and cultural illustrations based on your requests</li>
                    <li>🍲 <strong>Cuisine & Culinary Traditions</strong>: Traditional recipes and their cultural context</li>
                </ul>
                
                <div class="culture-quote" style="margin: 1.5rem 0;" id="about-quote2">
                    🌍 My approach: I always contextualize information, make it alive and regularly check understanding.
                </div>
                
                <p id="about-content-p4">I adapt to everyone's level and needs, value contributions and questions, and maintain a balance between seriousness and accessibility.</p>
                
                <p id="about-content-p5"><strong>Nice to meet you! What discovery would you like to make together?</strong></p>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="privacy-modal">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-title" id="privacy-modal-title">Privacy Policy</div>
                <button class="modal-close" id="privacy-close">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-content">
                <p id="privacy-content-p1">At CultureLink, we take the protection of your data very seriously. Linky 🐇 is designed to be your trusted companion in cultural and educational exploration.</p>
                
                <div class="culture-quote" style="margin: 1.5rem 0;" id="privacy-quote1">
                    🔒 Our commitment: Total transparency and respect for your privacy
                </div>
                
                <p id="privacy-content-p2"><strong>Data collection:</strong></p>
                <ul id="privacy-list1">
                    <li>We only collect information necessary for the functioning of our service</li>
                    <li>Your conversations with Linky are saved to improve your experience</li>
                    <li>The traditions and knowledge you share feed our living cultural memory (with your consent)</li>
                </ul>
                
                <p id="privacy-content-p3"><strong>Data usage:</strong></p>
                <ul id="privacy-list2">
                    <li>Improve your CultureLink experience and personalize Linky's responses</li>
                    <li>Preserve and share cultural knowledge (always respecting confidentiality)</li>
                    <li>Develop new educational and cultural features</li>
                </ul>
                
                <p id="privacy-content-p4"><strong>Protection:</strong></p>
                <ul id="privacy-list3">
                    <li>We implement robust security measures to protect your data</li>
                    <li>Your conversations are treated with the strictest confidentiality</li>
                    <li>We never share your personal information with third parties</li>
                </ul>
                
                <p id="privacy-content-p5"><strong>Your rights:</strong></p>
                <ul id="privacy-list4">
                    <li>You have the right to access, modify or delete your personal data at any time</li>
                    <li>You can export your conversations if you wish</li>
                    <li>You have full control over the information you share</li>
                </ul>
                
                <div class="culture-quote" style="margin: 1.5rem 0;" id="privacy-quote2">
                    🤝 Our philosophy: Your trust is our absolute priority
                </div>
                
                <p id="privacy-content-p6">CultureLink is more than an application - it's a space of trust where culture and knowledge flourish in mutual respect.</p>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="help-modal">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-title" id="help-modal-title">Help & Tutorial</div>
                <button class="modal-close" id="help-close">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-content">
                <p id="help-content-p1">Welcome to CultureLink! I'm Linky 🐇, your cultural and educational assistant. Here's how to get the most out of our interaction:</p>
                
                <div class="culture-quote" style="margin: 1.5rem 0;" id="help-quote1">
                    🎯 My goal: Make your learning enjoyable and enriching
                </div>
                
                <p id="help-content-p2"><strong>How to interact with me:</strong></p>
                <ul id="help-list1">
                    <li><strong>Varied greetings</strong>: I adapt to your mood and the time of day</li>
                    <li><strong>Structured explanations</strong>: My responses are clear and well organized</li>
                    <li><strong>Follow-up questions</strong>: I always check your understanding</li>
                    <li><strong>Adaptation to your level</strong>: I adjust to your knowledge and needs</li>
                </ul>
                
                <p id="help-content-p3"><strong>What I can do for you:</strong></p>
                <ul id="help-list2">
                    <li>📚 <strong>Explore cultures</strong>: History, traditions, arts, music, literature</li>
                    <li>🌱 <strong>Understand ecology</strong>: Biodiversity, preservation, traditional knowledge</li>
                    <li>🎓 <strong>Help you learn</strong>: Step-by-step explanations, homework help, presentation preparation</li>
                    <li>🎬 <strong>Discover anime</strong>: Recommendations, analysis, Japanese pop culture</li>
                    <li>🧩 <strong>Create activities</strong>: Educational quizzes, cultural challenges, learning games</li>
                    <li>🎨 <strong>Generate images</strong>: Create educational and cultural illustrations based on your specific requests</li>
                    <li>🍲 <strong>Discover cuisine</strong>: Traditional recipes and their history</li>
                </ul>
                
                <p id="help-content-p4"><strong>Image Generation Feature:</strong></p>
                <p id="help-content-p5">I can generate images based on your requests! Just ask me to create an image and describe what you'd like to see. I will generate a visual representation of your request. You can specify:</p>
                <ul id="help-list3">
                    <li>Subject (cultural, historical, ecological, etc.)</li>
                    <li>Style (realistic, artistic, cartoon, etc.)</li>
                    <li>Specific elements you want to include</li>
                    <li>Color or mood preferences</li>
                </ul>
                
                <p id="help-content-p6"><strong>Character limits:</strong></p>
                <ul id="help-list4">
                    <li><strong>Per message limit</strong>: 10,000 characters maximum</li>
                    <li><strong>Per conversation limit</strong>: 200,000 characters maximum</li>
                    <li>If you exceed these limits, I will inform you and suggest shortening your message or creating a new conversation</li>
                </ul>
                
                <p id="help-content-p7"><strong>Conversation management:</strong></p>
                <ul id="help-list5">
                    <li><strong>New conversation</strong>: A new conversation is automatically created each time you visit</li>
                    <li><strong>Pin</strong>: You can pin important conversations</li>
                    <li><strong>Rename</strong>: Click on a conversation title to edit it</li>
                    <li><strong>Delete</strong>: Delete conversations you no longer need</li>
                </ul>
                
                <p id="help-content-p8"><strong>My teaching method:</strong></p>
                <ul id="help-list6">
                    <li>I always start by assessing your knowledge level</li>
                    <li>I explain complex concepts in a simple and progressive way</li>
                    <li>I provide concrete examples and relevant analogies</li>
                    <li>I regularly check your understanding with questions</li>
                    <li>I always end with an open question to continue the exchange</li>
                </ul>
                
                <div class="culture-quote" style="margin: 1.5rem 0;" id="help-quote2">
                    💡 Tip: The more specific you are in your questions, the more precisely I can help you!
                </div>
                
                <p id="help-content-p9">Don't hesitate to ask me absolutely everything that interests or questions you. I'm here to accompany your curiosity with kindness and expertise!</p>
                
                <p id="help-content-p10"><strong>Ready to explore the world together? 🐇🇧🇫</strong></p>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="contact-modal">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-title" id="contact-modal-title">Contact</div>
                <button class="modal-close" id="contact-close">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-content">
                <p id="contact-content-p1">You can contact us via WhatsApp at the following numbers:</p>
                <p id="contact-content-p2"><strong>+226 07 19 80 89</strong> - PORGHO W Asraf Barrak Friday</p>
                <p id="contact-content-p3"><strong>+226 03 99 64 69</strong> - Tall Abdoul Souaïbou</p>
                
                <div class="culture-quote" style="margin: 1.5rem 0;" id="contact-quote1">
                    💬 We are always happy to exchange with our community!
                </div>
                
                <p id="contact-content-p4">Feel free to share with us:</p>
                <ul id="contact-list1">
                    <li>Your improvement suggestions</li>
                    <li>Your feedback with Linky</li>
                    <li>Traditions or knowledge you want to share</li>
                    <li>Bugs or technical issues</li>
                    <li>Your ideas for new features</li>
                </ul>
                
                <a href="https://wa.me/22607198089" class="whatsapp-link" target="_blank">
                    <i class="fab fa-whatsapp"></i> Contact on WhatsApp
                </a>
                <a href="https://wa.me/22603996469" class="whatsapp-link" target="_blank" style="margin-left: 10px;">
                    <i class="fab fa-whatsapp"></i> Second number
                </a>
                
                <p id="contact-content-p5" style="margin-top: 1.5rem;"><strong>CultureLink</strong> - Created in Burkina Faso 🇧🇫, designed for the world 🌍</p>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="whatsapp-modal">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-title" id="whatsapp-modal-title">WhatsApp Version of Linky</div>
                <button class="modal-close" id="whatsapp-close">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-content">
                <p id="whatsapp-content-p1">The WhatsApp version of Linky is currently in development!</p>
                
                <div class="culture-quote" style="margin: 1.5rem 0;" id="whatsapp-quote1">
                    📱 Soon, chat with Linky directly from WhatsApp!
                </div>
                
                <p id="whatsapp-content-p2">We are actively working to integrate Linky on WhatsApp to offer you an even more accessible and practical experience.</p>
                
                <p id="whatsapp-content-p3"><strong>Planned features:</strong></p>
                <ul id="whatsapp-list1">
                    <li>Access Linky from any device with WhatsApp</li>
                    <li>Receive instant responses to your cultural questions</li>
                    <li>Easily share discoveries with your loved ones</li>
                    <li>Benefit from all of Linky's expertise in instant messaging</li>
                </ul>
                
                <p id="whatsapp-content-p4"><strong>Advantages:</strong></p>
                <ul id="whatsapp-list2">
                    <li>No application installation required</li>
                    <li>Familiar and intuitive interface</li>
                    <li>Access from anywhere in the world</li>
                    <li>Conversations automatically saved</li>
                </ul>
                
                <div class="culture-quote" style="margin: 1.5rem 0;" id="whatsapp-quote2">
                    🚀 Stay tuned for launch announcements!
                </div>
                
                <p id="whatsapp-content-p5">In the meantime, you can already enjoy all of Linky's features on the CultureLink application.</p>
                
                <p id="whatsapp-content-p6"><strong>The future of cultural assistance is just a message away!</strong></p>
            </div>
        </div>
    </div>
    
    <!-- Overlay for panels -->
    <div class="overlay" id="overlay"></div>

    <script>
    // ===== GESTION SIMPLIFIÉE DE LA LANGUE =====
    const languageToggle = document.getElementById('language-toggle');
    let isEnglish = true;

    // Traductions (gardez vos traductions existantes)
    const translations = {
        en: {
            // ... vos traductions anglaises existantes
        },
        fr: {
            // ... vos traductions françaises existantes
        }
    };

    languageToggle.addEventListener('click', () => {
        isEnglish = !isEnglish;
        languageToggle.textContent = isEnglish ? '🇬🇧' : '🇫🇷';
        const langKey = isEnglish ? 'en' : 'fr';
        const t = translations[langKey];
        
        // Mise à jour des textes (gardez votre code de traduction existant)
        // ... votre code de traduction existant
    });

    // ===== CONFIGURATION DE L'API =====
    const API_URL = 'https://tpolli-1.onrender.com/ask';
    let isApiCallInProgress = false;

    // ===== SYSTÈME DE GESTION DES CONVERSATIONS =====

    // ÉTATS DE L'APPLICATION
    let currentTheme = 'light';
    let isTyping = false;
    let isPaused = false;
    let currentPausedMessage = null;
    let isMoreActionsExpanded = false;
    
    // SYSTÈME DE CONVERSATIONS
    let conversations = [];
    let currentConversationId = null;
    let autoScrollEnabled = true;
    let isModalOpen = false;
    
    // LIMITES DE CARACTÈRES
    const MESSAGE_CHAR_LIMIT = 10000;
    const CONVERSATION_CHAR_LIMIT = 200000;
    
    // ÉLÉMENTS DOM
    let homeInterface, chatInterface, messagesContainer, newConversation, conversationMessages, 
        messageInput, typingIndicator, sendBtn, inputWrapper, conversationsPanel, settingsPanel, 
        conversationList, overlay, quickActions, moreActionsBtn, scrollToBottomBtn, charCount, 
        charLimitWarning;
    
    // BOUTONS
    let startChatBtn, backBtn, themeBtn, settingsBtn, downloadHeaderBtn, downloadMainBtn, 
        helloBtn, conversationsBtn, panelClose, settingsPanelClose, panelThemeBtn, panelNewChatBtn;
    
    // BOUTONS DES PARAMÈTRES
    let settingsThemeBtn, settingsAboutBtn, settingsHelpBtn, settingsPrivacyBtn, 
        settingsContactBtn, settingsWhatsappBtn;

    // MODALS
    let aboutModal, privacyModal, helpModal, contactModal, whatsappModal;
    let aboutClose, privacyClose, helpClose, contactClose, whatsappClose;

    // ===== MODÈLES DE DONNÉES =====
    
    class Conversation {
        constructor(id, title) {
            this.id = id;
            this.title = title;
            this.messages = [];
            this.createdAt = new Date();
            this.updatedAt = new Date();
            this.pinned = false;
            this.totalChars = 0;
        }
    }
    
    class Message {
        constructor(id, type, content, sender, timestamp) {
            this.id = id;
            this.type = type;
            this.content = content;
            this.sender = sender;
            this.timestamp = timestamp;
            this.charCount = content.length;
        }
    }

    // ===== FONCTIONS UTILITAIRES =====
    
    function generateId() {
        return 'id_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
    }
    
    function debounce(func, delay) {
        let timeout;
        return function (...args) {
            clearTimeout(timeout);
            timeout = setTimeout(() => func.apply(this, args), delay);
        };
    }
    
    function formatTime(date) {
        return new Date(date).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
    }
    
    function formatDate(date) {
        const today = new Date();
        today.setHours(0, 0, 0, 0);
        
        const yesterday = new Date(today);
        yesterday.setDate(yesterday.getDate() - 1);
        
        const dateObj = new Date(date);
        dateObj.setHours(0, 0, 0, 0);
        
        if (dateObj.getTime() === today.getTime()) {
            return "Aujourd'hui";
        } else if (dateObj.getTime() === yesterday.getTime()) {
            return "Hier";
        } else {
            return dateObj.toLocaleDateString('fr-FR', { 
                month: 'short', 
                day: 'numeric' 
            });
        }
    }

    // ===== INITIALISATION =====
    function initApp() {
        initializeDOMElements();
        
        if (!conversationMessages || !messageInput || !sendBtn) {
            console.error('Éléments DOM critiques manquants');
            return;
        }
        
        // Événements de navigation
        if (startChatBtn) startChatBtn.addEventListener('click', showChat);
        if (backBtn) backBtn.addEventListener('click', showHome);
        
        // Événements du thème
        if (themeBtn) themeBtn.addEventListener('click', toggleTheme);
        if (panelThemeBtn) panelThemeBtn.addEventListener('click', toggleTheme);
        if (settingsThemeBtn) settingsThemeBtn.addEventListener('click', toggleTheme);
        
        // Événements du chat
        if (sendBtn) sendBtn.addEventListener('click', sendMessage);
        if (helloBtn) helloBtn.addEventListener('click', sendHello);
        if (messageInput) {
            messageInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    sendMessage();
                }
            });
        }
        
        // Compteur de caractères
        if (messageInput) {
            messageInput.addEventListener('input', () => {
                if (messageInput.value.length > MESSAGE_CHAR_LIMIT) {
                    messageInput.value = messageInput.value.substring(0, MESSAGE_CHAR_LIMIT);
                }
                updateCharCount();
            });
        }
        
        // Événements des panneaux
        if (conversationsBtn) conversationsBtn.addEventListener('click', showConversationsPanel);
        if (panelClose) panelClose.addEventListener('click', hidePanels);
        if (settingsPanelClose) settingsPanelClose.addEventListener('click', hidePanels);
        if (panelNewChatBtn) panelNewChatBtn.addEventListener('click', newChat);
        if (settingsBtn) settingsBtn.addEventListener('click', showSettingsPanel);
        if (overlay) overlay.addEventListener('click', hidePanels);
        
        // Événements des paramètres
        if (settingsAboutBtn) settingsAboutBtn.addEventListener('click', () => showModal('about'));
        if (settingsHelpBtn) settingsHelpBtn.addEventListener('click', () => showModal('help'));
        if (settingsPrivacyBtn) settingsPrivacyBtn.addEventListener('click', () => showModal('privacy'));
        if (settingsContactBtn) settingsContactBtn.addEventListener('click', () => showModal('contact'));
        if (settingsWhatsappBtn) settingsWhatsappBtn.addEventListener('click', () => showModal('whatsapp'));
        
        // Événements des modals
        if (aboutClose) aboutClose.addEventListener('click', () => hideModal('about'));
        if (privacyClose) privacyClose.addEventListener('click', () => hideModal('privacy'));
        if (helpClose) helpClose.addEventListener('click', () => hideModal('help'));
        if (contactClose) contactClose.addEventListener('click', () => hideModal('contact'));
        if (whatsappClose) whatsappClose.addEventListener('click', () => hideModal('whatsapp'));
        
        // Événements des boutons de téléchargement
        if (downloadHeaderBtn) downloadHeaderBtn.addEventListener('click', downloadApp);
        if (downloadMainBtn) downloadMainBtn.addEventListener('click', downloadApp);
        
        // Événements des boutons d'actions rapides
        setupQuickActions();
        if (moreActionsBtn) moreActionsBtn.addEventListener('click', toggleMoreActions);
        
        // Ajuster la hauteur du textarea
        if (messageInput) {
            messageInput.addEventListener('input', autoResizeTextarea);
        }
        
        // Mettre à jour l'icône du thème
        updateThemeIcon();
        
        // Initialiser l'affichage des boutons d'actions rapides
        hideExtraQuickActions();
        
        // Événement pour le bouton de défilement vers le bas
        if (scrollToBottomBtn) {
            scrollToBottomBtn.addEventListener('click', () => {
                scrollToBottom(true);
            });
        }
        
        // Surveiller le défilement
        if (messagesContainer) {
            messagesContainer.addEventListener('scroll', debounce(handleScroll, 100));
        }
        
        // Initialiser le compteur de caractères
        updateCharCount();
        
        // Charger les conversations sauvegardées
        loadSavedConversations();
    }

    function initializeDOMElements() {
        homeInterface = document.getElementById('home-interface');
        chatInterface = document.getElementById('chat-interface');
        messagesContainer = document.getElementById('messages-container');
        newConversation = document.getElementById('new-conversation');
        conversationMessages = document.getElementById('conversation-messages');
        messageInput = document.getElementById('message-input');
        typingIndicator = document.getElementById('typing-indicator');
        sendBtn = document.getElementById('send-btn');
        conversationsPanel = document.getElementById('conversations-panel');
        settingsPanel = document.getElementById('settings-panel');
        conversationList = document.getElementById('conversation-list');
        overlay = document.getElementById('overlay');
        quickActions = document.getElementById('quick-actions');
        moreActionsBtn = document.getElementById('more-actions-btn');
        scrollToBottomBtn = document.getElementById('scroll-to-bottom');
        charCount = document.getElementById('char-count');
        charLimitWarning = document.getElementById('char-limit-warning');
        
        // BOUTONS
        startChatBtn = document.getElementById('start-chat-btn');
        backBtn = document.getElementById('back-btn');
        themeBtn = document.getElementById('theme-btn');
        settingsBtn = document.getElementById('settings-btn');
        downloadHeaderBtn = document.getElementById('download-header-btn');
        downloadMainBtn = document.getElementById('download-main-btn');
        helloBtn = document.getElementById('hello-btn');
        conversationsBtn = document.getElementById('conversations-btn');
        panelClose = document.getElementById('panel-close');
        settingsPanelClose = document.getElementById('settings-panel-close');
        panelThemeBtn = document.getElementById('panel-theme-btn');
        panelNewChatBtn = document.getElementById('panel-new-chat-btn');
        
        // BOUTONS DES PARAMÈTRES
        settingsThemeBtn = document.getElementById('settings-theme-btn');
        settingsAboutBtn = document.getElementById('settings-about-btn');
        settingsHelpBtn = document.getElementById('settings-help-btn');
        settingsPrivacyBtn = document.getElementById('settings-privacy-btn');
        settingsContactBtn = document.getElementById('settings-contact-btn');
        settingsWhatsappBtn = document.getElementById('settings-whatsapp-btn');

        // MODALS
        aboutModal = document.getElementById('about-modal');
        privacyModal = document.getElementById('privacy-modal');
        helpModal = document.getElementById('help-modal');
        contactModal = document.getElementById('contact-modal');
        whatsappModal = document.getElementById('whatsapp-modal');
        
        aboutClose = document.getElementById('about-close');
        privacyClose = document.getElementById('privacy-close');
        helpClose = document.getElementById('help-close');
        contactClose = document.getElementById('contact-close');
        whatsappClose = document.getElementById('whatsapp-close');
    }

    // ===== API FONCTIONNELLE (COMME VOTRE EXEMPLE) =====
    
    async function callLinkyAPI(userMessage) {
        try {
            // MÊME TECHNIQUE QUE VOTRE EXEMPLE QUI FONCTIONNE
            const response = await fetch(`${API_URL}?prompt=${encodeURIComponent(userMessage)}`);
            
            if (!response.ok) {
                throw new Error(`Erreur HTTP: ${response.status}`);
            }
            
            const data = await response.json();
            
            if (!data.reply) {
                throw new Error('Format de réponse invalide');
            }
            
            return data.reply;
            
        } catch (error) {
            console.error('Erreur API:', error);
            
            // Réponses par défaut selon le type d'erreur
            if (error.message.includes('Failed to fetch') || error.message.includes('NetworkError')) {
                return "🌐 **Problème de connexion**\n\nJe ne peux pas me connecter au serveur. Vérifiez votre connexion internet.";
            } else if (error.message.includes('CORS')) {
                return "🛡️ **Astuce technique**\n\nEssayez d'ouvrir cette page dans une nouvelle fenêtre privée ou utilisez Firefox.";
            } else {
                // Réponses par défaut adaptatives
                const lowerMessage = userMessage.toLowerCase();
                
                if (lowerMessage.includes('bonjour') || lowerMessage.includes('hello') || lowerMessage.includes('salut')) {
                    return "Bonjour ! Je suis Linky 🐇, votre assistant culturel. Comment puis-je vous aider aujourd'hui ?";
                }
                
                if (lowerMessage.includes('culture') || lowerMessage.includes('afric')) {
                    return "🇧🇫 **Culture Africaine**\n\nLa culture africaine est riche et diverse ! Je peux vous parler des civilisations Mossi, des traditions Dogon, ou de l'art Yoruba. Que voulez-vous savoir exactement ?";
                }
                
                if (lowerMessage.includes('écologie') || lowerMessage.includes('nature') || lowerMessage.includes('environnement')) {
                    return "🌱 **Écologie & Environnement**\n\nL'écologie africaine est unique ! Parlons de biodiversité, de savoirs traditionnels ou de protection de l'environnement. Quelle est votre question ?";
                }
                
                if (lowerMessage.includes('anime') || lowerMessage.includes('manga') || lowerMessage.includes('film')) {
                    return "🎬 **Anime & Divertissement**\n\nJ'adore les anime ! Mon préféré est Attack on Titan 🔥. Voulez-vous une recommandation ou une analyse ?";
                }
                
                return "🐇 **Linky à votre service !**\n\nJe suis votre assistant culturel. Posez-moi vos questions sur :\n• Culture & histoire africaine\n• Écologie & environnement\n• Anime & divertissement\n• Pédagogie & apprentissage\n\nQue voulez-vous explorer aujourd'hui ?";
            }
        }
    }

    // ===== GESTION DES MESSAGES =====
    
    function formatResponse(text) {
        if (!text) return '';
        
        let formatted = text.replace(/\n/g, '<br>');
        formatted = formatted.replace(/^-/gm, '• ');
        formatted = formatted.replace(/<br><br>/g, '</p><p>');
        
        return `<div class="formatted-response"><p>${formatted}</p></div>`;
    }
    
    function addMessageToDOM(message, animate = true) {
        if (!conversationMessages) return null;
        
        const messageDiv = document.createElement('div');
        messageDiv.className = `message ${message.sender}-message ${message.type}-message`;
        
        if (animate) {
            messageDiv.style.animation = 'messageSlideIn 0.3s ease';
        }
        
        const avatar = message.sender === 'user' ? 'U' : 'L';
        const time = formatTime(message.timestamp);
        
        const content = message.sender === 'bot' ? formatResponse(message.content) : message.content;
        
        messageDiv.innerHTML = `
            <div class="message-content">
                <div class="message-avatar">${avatar}</div>
                <div class="message-text">
                    ${content}
                    <div class="message-time">${time}</div>
                </div>
            </div>
        `;
        
        conversationMessages.appendChild(messageDiv);
        return messageDiv;
    }
    
    // ===== FONCTION PRINCIPALE D'ENVOI =====
    
    async function sendMessage() {
        if (!messageInput) return;
        
        const text = messageInput.value.trim();
        if (!text || isApiCallInProgress) return;

        if (text.length > MESSAGE_CHAR_LIMIT) {
            showCharLimitWarning('message');
            return;
        }

        // Masquer la zone de bienvenue si premier message
        if (!currentConversationId || conversations.find(c => c.id === currentConversationId)?.messages.length === 0) {
            if (newConversation) newConversation.style.display = 'none';
            if (conversationMessages) conversationMessages.style.display = 'block';
        }

        // Créer conversation si nécessaire
        if (!currentConversationId) {
            createNewConversation(text);
        }

        // Ajouter message utilisateur
        const userMessage = new Message(
            generateId(),
            'text',
            text,
            'user',
            new Date()
        );
        
        addMessageToConversation(userMessage);
        addMessageToDOM(userMessage);
        
        messageInput.value = '';
        updateCharCount();
        autoResizeTextarea();
        scrollToBottom();
        
        // Obtenir réponse de l'API
        await getBotResponse(text);
    }
    
    async function getBotResponse(userMessage) {
        isTyping = true;
        isApiCallInProgress = true;
        
        if (sendBtn) {
            sendBtn.disabled = true;
            sendBtn.innerHTML = '<i class="fas fa-circle-notch fa-spin"></i>';
        }
        
        // Afficher indicateur de frappe
        if (typingIndicator) {
            typingIndicator.style.display = 'flex';
        }
        scrollToBottom();
        
        try {
            // Appeler l'API (MÊME TECHNIQUE QUE VOTRE EXEMPLE)
            const apiResponse = await callLinkyAPI(userMessage);
            
            // Créer message du bot
            const botMessage = new Message(
                generateId(),
                'text',
                apiResponse,
                'bot',
                new Date()
            );
            
            // Ajouter avec effet de frappe
            addMessageWithTypingEffect(botMessage);
            
        } catch (error) {
            console.error('Erreur lors de la réponse:', error);
            
            const errorMessage = new Message(
                generateId(),
                'text',
                "Je suis désolé, je rencontre un problème technique. Veuillez réessayer.",
                'bot',
                new Date()
            );
            
            addMessageWithTypingEffect(errorMessage);
            
        } finally {
            finishTyping();
        }
    }
    
    function addMessageWithTypingEffect(message) {
        const messageDiv = addMessageToDOM({
            ...message,
            content: ''
        }, false);
        
        if (!messageDiv) {
            finishTyping();
            return;
        }
        
        const messageText = messageDiv.querySelector('.message-text');
        if (!messageText) {
            finishTyping();
            return;
        }
        
        const currentTypingMessage = message.content;
        let typingIndex = 0;
        
        scrollToBottom(true);
        
        function typeStep() {
            if (typingIndex < currentTypingMessage.length && !isPaused) {
                const partialContent = currentTypingMessage.substring(0, typingIndex + 1);
                messageText.innerHTML = formatResponse(partialContent) + `<div class="message-time">${formatTime(message.timestamp)}</div>`;
                typingIndex++;
                
                if (typingIndex % 3 === 0) {
                    scrollToBottom();
                }
                
                requestAnimationFrame(typeStep);
            } else if (typingIndex >= currentTypingMessage.length) {
                messageText.innerHTML = formatResponse(currentTypingMessage) + `<div class="message-time">${formatTime(message.timestamp)}</div>`;
                scrollToBottom(true);
                addMessageToConversation(message);
                finishTyping();
            }
        }
        
        requestAnimationFrame(typeStep);
    }
    
    function finishTyping() {
        isTyping = false;
        isPaused = false;
        isApiCallInProgress = false;
        
        if (sendBtn) {
            sendBtn.disabled = false;
            sendBtn.innerHTML = '<i class="fas fa-arrow-up"></i>';
        }
        
        if (typingIndicator) {
            typingIndicator.style.display = 'none';
        }
    }

    // ===== GESTION DES CONVERSATIONS =====
    
    function createNewConversation(firstMessage = null) {
        const id = generateId();
        
        let title;
        if (firstMessage) {
            title = (firstMessage.length > 30 ? firstMessage.substring(0, 30) + '...' : firstMessage);
            
            let counter = 1;
            let baseTitle = title;
            while (conversations.some(c => c.title === title)) {
                title = `${baseTitle} (${counter})`;
                counter++;
            }
        } else {
            title = "Nouvelle conversation";
        }
        
        const conversation = new Conversation(id, title);
        conversations.unshift(conversation);
        currentConversationId = id;
        
        saveConversations();
        updateConversationList();
        updateConversationName();
        
        return conversation;
    }
    
    function addMessageToConversation(message, conversationId = null) {
        const targetConversationId = conversationId || currentConversationId;
        const conversation = conversations.find(c => c.id === targetConversationId);
        
        if (!conversation) return null;
        
        if (conversation.totalChars + message.charCount > CONVERSATION_CHAR_LIMIT) {
            showCharLimitWarning('conversation');
            return null;
        }
        
        conversation.messages.push(message);
        conversation.updatedAt = new Date();
        conversation.totalChars += message.charCount;
        
        saveConversations();
        updateConversationList();
        
        return conversation;
    }
    
    function saveConversations() {
        localStorage.setItem('culturelink_conversations', JSON.stringify(conversations));
    }
    
    function loadSavedConversations() {
        const saved = localStorage.getItem('culturelink_conversations');
        if (saved) {
            try {
                const parsed = JSON.parse(saved);
                conversations = parsed.map(conv => {
                    const conversation = new Conversation(conv.id, conv.title);
                    conversation.messages = conv.messages || [];
                    conversation.createdAt = new Date(conv.createdAt);
                    conversation.updatedAt = new Date(conv.updatedAt);
                    conversation.pinned = conv.pinned || false;
                    conversation.totalChars = conv.totalChars || 0;
                    return conversation;
                });
                
                updateConversationList();
            } catch (e) {
                console.error('Erreur chargement conversations:', e);
                conversations = [];
            }
        }
    }
    
    function updateConversationList() {
        if (!conversationList) return;
        
        conversationList.innerHTML = '';
        
        const nonEmptyConversations = conversations.filter(c => c.messages.length > 0);
        
        if (nonEmptyConversations.length === 0) {
            conversationList.innerHTML = `<div style="text-align: center; opacity: 0.7; padding: 1rem;">Aucune conversation</div>`;
            return;
        }
        
        const sortedConversations = [...nonEmptyConversations].sort((a, b) => {
            if (a.pinned && !b.pinned) return -1;
            if (!a.pinned && b.pinned) return 1;
            return new Date(b.updatedAt) - new Date(a.updatedAt);
        });
        
        sortedConversations.forEach(conversation => {
            conversationList.appendChild(createConversationItem(conversation));
        });
    }
    
    function createConversationItem(conversation) {
        const conversationItem = document.createElement('div');
        conversationItem.className = `conversation-item ${conversation.id === currentConversationId ? 'active' : ''} ${conversation.pinned ? 'pinned' : ''}`;
        
        const lastMessage = conversation.messages[conversation.messages.length - 1];
        const preview = lastMessage ? (lastMessage.content.length > 50 ? lastMessage.content.substring(0, 50) + '...' : lastMessage.content) : "Nouvelle conversation";
        
        const timeStr = formatTime(conversation.updatedAt);
        const dateStr = formatDate(conversation.updatedAt);
        
        conversationItem.innerHTML = `
            <div class="conversation-avatar">L</div>
            <div class="conversation-info">
                <div class="conversation-title">${conversation.title}</div>
                <div class="conversation-preview">${preview}</div>
                <div class="conversation-date">${dateStr} • ${timeStr}</div>
            </div>
            <div class="conversation-actions">
                <button class="conversation-action-btn delete-btn" title="Supprimer">
                    <i class="fas fa-trash"></i>
                </button>
            </div>
        `;
        
        conversationItem.addEventListener('click', () => {
            loadConversation(conversation.id);
            hidePanels();
        });
        
        const deleteBtn = conversationItem.querySelector('.delete-btn');
        deleteBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            deleteConversation(conversation.id);
        });
        
        return conversationItem;
    }
    
    function deleteConversation(conversationId) {
        if (confirm('Supprimer cette conversation ?')) {
            conversations = conversations.filter(c => c.id !== conversationId);
            
            if (currentConversationId === conversationId) {
                if (conversations.length > 0) {
                    loadConversation(conversations[0].id);
                } else {
                    currentConversationId = null;
                    clearChatInterface();
                }
            }
            
            updateConversationList();
            saveConversations();
        }
    }
    
    function loadConversation(conversationId) {
        if (isApiCallInProgress) {
            finishTyping();
        }
        
        if (currentConversationId === conversationId) return;
        
        const conversation = conversations.find(c => c.id === conversationId);
        if (!conversation) return;
        
        currentConversationId = conversationId;
        renderConversationMessages(conversation);
        
        if (newConversation) newConversation.style.display = 'none';
        if (conversationMessages) conversationMessages.style.display = 'block';
        
        updateConversationName();
        scrollToBottom(true);
    }
    
    function renderConversationMessages(conversation) {
        if (!conversationMessages) return;
        
        conversationMessages.innerHTML = '';
        conversation.messages.forEach(message => {
            addMessageToDOM(message, false);
        });
    }

    // ===== FONCTIONS D'INTERFACE =====
    
    function showChat() {
        if (homeInterface) homeInterface.classList.remove('active');
        if (chatInterface) chatInterface.classList.add('active');
        if (newConversation) newConversation.style.display = 'flex';
        if (conversationMessages) conversationMessages.style.display = 'none';
        currentConversationId = null;
    }

    function showHome() {
        if (chatInterface) chatInterface.classList.remove('active');
        if (homeInterface) homeInterface.classList.add('active');
    }

    function toggleTheme() {
        currentTheme = currentTheme === 'light' ? 'dark' : 'light';
        document.body.setAttribute('data-theme', currentTheme);
        updateThemeIcon();
    }

    function updateThemeIcon() {
        const themeIcons = document.querySelectorAll('#theme-btn i, #panel-theme-btn i, #settings-theme-btn i');
        themeIcons.forEach(icon => {
            if (currentTheme === 'light') {
                icon.className = 'fas fa-sun';
            } else {
                icon.className = 'fas fa-moon';
            }
        });
    }

    function showConversationsPanel() {
        if (conversationsPanel) conversationsPanel.classList.add('active');
        if (overlay) overlay.classList.add('active');
        document.body.classList.add('no-scroll');
        updateConversationList();
    }

    function showSettingsPanel() {
        if (settingsPanel) settingsPanel.classList.add('active');
        if (overlay) overlay.classList.add('active');
        document.body.classList.add('no-scroll');
    }

    function hidePanels() {
        if (conversationsPanel) conversationsPanel.classList.remove('active');
        if (settingsPanel) settingsPanel.classList.remove('active');
        if (overlay) overlay.classList.remove('active');
        document.body.classList.remove('no-scroll');
    }

    function newChat() {
        createNewConversation();
        clearChatInterface();
        hidePanels();
    }
    
    function clearChatInterface() {
        if (conversationMessages) conversationMessages.innerHTML = '';
        if (newConversation) newConversation.style.display = 'flex';
        if (conversationMessages) conversationMessages.style.display = 'none';
        updateConversationName();
        
        if (isTyping) {
            finishTyping();
        }
    }
    
    function updateConversationName() {
        const conversation = conversations.find(c => c.id === currentConversationId);
        const displayElement = document.getElementById('conversation-name-display');
        if (displayElement) {
            displayElement.textContent = conversation ? conversation.title : "Nouvelle conversation";
        }
    }

    function sendHello() {
        if (messageInput) {
            messageInput.value = "Hello 👋";
            sendMessage();
        }
    }

    function setupQuickActions() {
        const quickActionBtns = document.querySelectorAll('.quick-action-btn[data-message]');
        quickActionBtns.forEach(btn => {
            btn.addEventListener('click', (e) => {
                e.stopPropagation();
                const message = btn.getAttribute('data-message');
                if (messageInput) {
                    messageInput.value = message;
                    sendMessage();
                }
            });
        });
    }

    function hideExtraQuickActions() {
        const hiddenActions = document.querySelectorAll('.quick-action-btn.hidden-action');
        hiddenActions.forEach(action => {
            action.style.display = 'none';
        });
        if (moreActionsBtn) {
            moreActionsBtn.style.display = 'flex';
        }
        isMoreActionsExpanded = false;
    }

    function toggleMoreActions() {
        const hiddenActions = document.querySelectorAll('.quick-action-btn.hidden-action');
        
        if (isMoreActionsExpanded) {
            hiddenActions.forEach(action => {
                action.style.display = 'none';
            });
            if (moreActionsBtn) {
                moreActionsBtn.querySelector('.quick-action-text').textContent = "Plus";
            }
            isMoreActionsExpanded = false;
        } else {
            hiddenActions.forEach(action => {
                action.style.display = 'flex';
            });
            if (moreActionsBtn) {
                moreActionsBtn.querySelector('.quick-action-text').textContent = "Moins";
            }
            isMoreActionsExpanded = true;
        }
    }

    function scrollToBottom(force = false) {
        if (isModalOpen || !messagesContainer) return;
        
        if (force || autoScrollEnabled) {
            setTimeout(() => {
                messagesContainer.scrollTo({
                    top: messagesContainer.scrollHeight,
                    behavior: force ? 'smooth' : 'instant'
                });
                
                if (force && scrollToBottomBtn) {
                    scrollToBottomBtn.classList.remove('visible');
                }
            }, 50);
        }
    }
    
    function handleScroll() {
        if (isModalOpen || !messagesContainer || !scrollToBottomBtn) return;
        
        const threshold = 200;
        const scrollPosition = messagesContainer.scrollTop;
        const containerHeight = messagesContainer.clientHeight;
        const contentHeight = messagesContainer.scrollHeight;
        
        const distanceFromBottom = contentHeight - scrollPosition - containerHeight;
        const isNearBottom = distanceFromBottom < threshold;
        
        if (isNearBottom) {
            autoScrollEnabled = true;
            scrollToBottomBtn.classList.remove('visible');
        } else {
            autoScrollEnabled = false;
            scrollToBottomBtn.classList.add('visible');
        }
    }

    function updateCharCount() {
        if (!charCount || !messageInput) return;
        
        const count = messageInput.value.length;
        charCount.textContent = count;
        
        if (count > MESSAGE_CHAR_LIMIT) {
            charCount.style.color = '#ef4444';
            if (charLimitWarning) charLimitWarning.style.display = 'block';
        } else {
            charCount.style.color = '';
            if (charLimitWarning) charLimitWarning.style.display = 'none';
        }
    }
    
    function showCharLimitWarning(type) {
        if (type === 'message') {
            alert("Message trop long (limite: 10,000 caractères)");
        } else if (type === 'conversation') {
            alert("Limite de conversation atteinte (200,000 caractères)");
        }
    }

    function autoResizeTextarea() {
        if (!messageInput) return;
        
        messageInput.style.height = 'auto';
        const newHeight = Math.min(messageInput.scrollHeight, 120);
        messageInput.style.height = newHeight + 'px';
        
        setTimeout(() => {
            scrollToBottom();
        }, 50);
    }

    function showModal(modalName) {
        const modal = document.getElementById(`${modalName}-modal`);
        if (modal) {
            modal.classList.add('active');
            isModalOpen = true;
        }
    }
    
    function hideModal(modalName) {
        const modal = document.getElementById(`${modalName}-modal`);
        if (modal) {
            modal.classList.remove('active');
            isModalOpen = false;
        }
    }

    function setupModalCloseHandlers() {
        document.addEventListener('click', (e) => {
            if (e.target.classList.contains('modal-overlay')) {
                const activeModal = document.querySelector('.modal-overlay.active');
                if (activeModal) {
                    activeModal.classList.remove('active');
                    isModalOpen = false;
                }
            }
        });
    }

    function downloadApp() {
        alert("L'application CultureLink sera bientôt disponible !");
    }

    // ===== DÉMARRAGE =====
    document.addEventListener('DOMContentLoaded', () => {
        try {
            initApp();
        } catch (error) {
            console.error('Erreur initialisation:', error);
        }
    });
</script>
</body>
</html>
